<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="box.css" />
    <link rel="stylesheet" href="oneofus.css" />
  </head>
  <!-- TODO: 
   reduce headings: cryptic and come in pairs
   embed Milhouse@nerdster.org recognized by Lisa
   -->
  <body>
    <main>
      <h1>Lisa Recognizes Identities!</h1>
      <div class="text-iframe-2col">
        <div class="content">
          <p>
            We see "Bart@nerdster.org" as following Milhouse because Bart used
            the Nerdster which signed the follow statement using the delegate
            key pair delegated to it.
            <br />"Bart@nerdster.org" is Bart. (Same as "Bart@ebay.com",
            "Bart@discord.com", etc..)
            <br />
          </p>
          <p>
            We see "Milhouse" simply (with no @domain) because that's who Bart
            wants to follow: a person, not an account.
          </p>
        </div>

        <div class="embed">
          <iframe id="flutterApp"></iframe>
        </div>
      </div>
      <h1>Identity Layer ties It All Together</h1>
      <ul>
        <li>It distributes keys.</li>
        <li>Everything is signed by someone's key.</li>
      </ul>
      <p>
        "Milhouse" and "Bart" are not available usernames that some users
        grabbed at nerdster.org.
        <br />
        They're who Lisa's network says they are, backed by a complete,
        cryptographic chain grounded by Lisa's own identity.
        <br />
        (On the
        <!-- DEFER: Add query parameters for ?fire=emulator -->
        <a href="home.html" target="_blank">Nerdster Simpsons Bot Farm</a>'s
        Lisa scanned her mom's phone, Marge scanned her kids' phones, and Bart
        scanned Milhouse's phone.)
      </p>
      <p>I am who your network says I am, across all services.</p>

      <a href="#" id="verifyTrustMom">Lisa trusts her mom</a>
      <a href="#" id="verifyMomRate">verifyMomRate</a>

      <h1>Your public key is your identity</h1>
      <p>
        You own your crypto key pair. It's yours, you own it. Use it to sign
        whatever you want.
        <br />
        The public component of your own public/private cryptographic key pair
        is your identity.
      </p>

      <h2>Crypto Keys are Cryptic</h2>
      <p>
        Unlike the usernames and passwords we're used to, public/private
        cryptographic key pairs are long and cryptic and can't practically be
        spoken or memorized. This is why we use QR codes (or occasionally
        copy/paste) to communicate them.
      </p>

      <ul>
        <li>QR codes allow us to communicate public keys using our phones.</li>
        <li>JSON format is used when computers communicate with each other.</li>
      </ul>

      <h2>Sample public key</h2>

      <div class="qr-json-2col">
        <img src="img/sample.png" alt="sample public key" />

        <pre><code>{
  "crv": "Ed25519",
  "kty": "OKP",
  "x": "rHT5B3q3rBCtNUaSBwT7DxT2Y0Q6fgvmhNKbVhJ_BtQ"
}
        </code></pre>
      </div>

      <h2>Sample public/private key pair</h2>
      <div class="qr-json-2col">
        <p>(We don't scan each other's private keys)</p>

        <pre><code>{
  "crv": "Ed25519",
  "kty": "OKP",
  "x": "rHT5B3q3rBCtNUaSBwT7DxT2Y0Q6fgvmhNKbVhJ_BtQ",
  "d": "_MaCrtWx2jHTOrujWXVeihaBBJHF09QUxzwnk6GGiEQ"
}
        </code></pre>
      </div>

      <h2>They come in Pairs</h2>
      <p>
        Lose your private key and your public key is now abandoned. You'll have
        to get a new pair, can't just replace the private key. (We address this
        with the "replace" statement; it's complicated.)
      </p>
    </main>

    <script src="iframe_helper.js"></script>
    <script src="data/demoData.js"></script>
    <script>
      (function () {
        const iframe = document.getElementById("flutterApp");
        if (!iframe) return;

        const identity = demoData["lisa"];

        const verify2 = demoData["bart-follow-milhouse-social"];
        console.log("verify2:", verify2);

        iframe.src = IframeHelper.constructUrl({
          identity: JSON.stringify(identity),
          verify2: JSON.stringify(verify2, null, 2),
          verifyImmediately: "true",
          showCrypto: "true",
          skipCredentialsDisplay: "true",
        });

        document
          .getElementById("verifyMomRate")
          .addEventListener("click", function (ev) {
            ev.preventDefault();
            iframe.contentWindow.postMessage(
              { verify2: JSON.stringify(demoData["marge-banana-rate"], null, 2) },
              "*"
            );
          });

        document
          .getElementById("verifyTrustMom")
          .addEventListener("click", function (ev) {
            ev.preventDefault();
            iframe.contentWindow.postMessage(
              { verify2: JSON.stringify(demoData["lisa-trust-mom"], null, 2) },
              "*"
            );
          });
      })();
    </script>
  </body>
</html>
